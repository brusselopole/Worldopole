function MarkerClusterer(a,b,c){this.extend(MarkerClusterer,google.maps.OverlayView),this.map_=a,this.markers_=[],this.clusters_=[],this.markersCluster_={},this.markersUniqueID=1,this.sizes=[53,56,66,78,90],this.styles_=[],this.cssClass_="",this.cssDefaultClass_="cluster",this.setIndex_=0,this.ready_=!1;var d=c||{};this.gridSize_=void 0!==d.gridSize?d.gridSize:60,this.minClusterSize_=d.minimumClusterSize||2,this.ignoreHiddenMarkers_=d.ignoreHiddenMarkers||!1,this.maxZoom_=d.maxZoom||null,this.styles_=d.styles||[],this.cssClass_=d.cssClass||null,this.imagePath_=d.imagePath||this.MARKER_CLUSTER_IMAGE_PATH_,this.imageExtension_=d.imageExtension||this.MARKER_CLUSTER_IMAGE_EXTENSION_,this.zoomOnClick_=!0,void 0!=d.zoomOnClick&&(this.zoomOnClick_=d.zoomOnClick),this.averageCenter_=!1,void 0!=d.averageCenter&&(this.averageCenter_=d.averageCenter),this.onMouseoverCluster_=d.onMouseoverCluster,this.onMouseoutCluster_=d.onMouseoutCluster,this.setupStyles_(),this.setMap(a),this.prevZoom_=this.map_.getZoom();var e=this;google.maps.event.addListener(this.map_,"zoom_changed",function(){var a=e.map_.getZoom();e.prevZoom_!=a&&(e.prevZoom_=a,e.resetViewport())}),google.maps.event.addListener(this.map_,"idle",function(){e.redraw()}),b&&b.length&&this.addMarkers(b,!1)}function Cluster(a){this.markerClusterer_=a,this.map_=a.getMap(),this.gridSize_=a.getGridSize(),this.minClusterSize_=a.getMinClusterSize(),this.averageCenter_=a.isAverageCenter(),this.center_=null,this.markers_=[],this.bounds_=null,this.clusterIcon_=new ClusterIcon(this,a.getStyles(),a.getGridSize())}function ClusterIcon(a,b,c){a.getMarkerClusterer().extend(ClusterIcon,google.maps.OverlayView),this.styles_=b,this.padding_=c||0,this.cluster_=a,this.center_=null,this.map_=a.getMap(),this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(this.map_)}MarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_PATH_="https://raw.githubusercontent.com/gmaps-marker-clusterer/gmaps-marker-clusterer/master/images/m",MarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_EXTENSION_="png",MarkerClusterer.prototype.extend=function(a,b){return function(a){for(var b in a.prototype)this.prototype[b]=a.prototype[b];return this}.apply(a,[b])},MarkerClusterer.prototype.onAdd=function(){this.setReady_(!0)},MarkerClusterer.prototype.draw=function(){},MarkerClusterer.prototype.setupStyles_=function(){if(!this.styles_.length)for(var b,a=0;b=this.sizes[a];a++){var c="";c="function"==typeof this.imagePath_?this.imagePath_(a,b):this.imagePath_+(a+1)+"."+this.imageExtension_,this.styles_.push({url:c,height:b,width:b})}},MarkerClusterer.prototype.fitMapToMarkers=function(){for(var d,a=this.getMarkers(),b=new google.maps.LatLngBounds,c=0;d=a[c];c++)b.extend(d.getPosition());this.map_.fitBounds(b)},MarkerClusterer.prototype.setStyles=function(a){this.styles_=a},MarkerClusterer.prototype.getStyles=function(){return this.styles_},MarkerClusterer.prototype.isZoomOnClick=function(){return this.zoomOnClick_},MarkerClusterer.prototype.isAverageCenter=function(){return this.averageCenter_},MarkerClusterer.prototype.getMarkers=function(){return this.markers_},MarkerClusterer.prototype.getTotalMarkers=function(){return this.markers_.length},MarkerClusterer.prototype.setMaxZoom=function(a){this.maxZoom_=a},MarkerClusterer.prototype.getMaxZoom=function(){return this.maxZoom_},MarkerClusterer.prototype.getMarkersCluster=function(a){return this.clusters_[this.markersCluster_[a.uniqueID]]},MarkerClusterer.prototype.calculator_=function(a,b){for(var c=0,d=a.length,e=d;0!==e;)e=parseInt(e/10,10),c++;return c=Math.min(c,b),{text:d,index:c}},MarkerClusterer.prototype.setCalculator=function(a){this.calculator_=a},MarkerClusterer.prototype.getCalculator=function(){return this.calculator_},MarkerClusterer.prototype.addMarkers=function(a,b){for(var d,c=0;d=a[c];c++)this.pushMarkerTo_(d);b||this.redraw()},MarkerClusterer.prototype.pushMarkerTo_=function(a){if(a.isAdded=!1,a.draggable){var b=this;google.maps.event.addListener(a,"dragend",function(){a.isAdded=!1,b.repaint()})}a.uniqueID=this.markersUniqueID,this.markersUniqueID++,this.markers_.push(a)},MarkerClusterer.prototype.addMarker=function(a,b){this.pushMarkerTo_(a),b||this.redraw()},MarkerClusterer.prototype.removeMarker_=function(a){var b=-1;if(this.markers_.indexOf)b=this.markers_.indexOf(a);else for(var d,c=0;d=this.markers_[c];c++)if(d==a){b=c;break}return-1!=b&&(a.setMap(null),this.markers_.splice(b,1),this.markersCluster_[a.uniqueID]&&this.clusters_[this.markersCluster_[a.uniqueID]].removeMarker(a),delete this.markersCluster_[a.uniqueID],!0)},MarkerClusterer.prototype.removeMarker=function(a){return this.removeMarker_(a)},MarkerClusterer.prototype.removeMarkers=function(a){for(var b=!1,c=a.length;c>=0;c--){var d=a[c],e=this.removeMarker_(d);b=b||e}return b},MarkerClusterer.prototype.setReady_=function(a){this.ready_||(this.ready_=a,this.createClusters_())},MarkerClusterer.prototype.getTotalClusters=function(){return this.clusters_.length},MarkerClusterer.prototype.getMap=function(){return this.map_},MarkerClusterer.prototype.setMap=function(a){this.map_=a},MarkerClusterer.prototype.getGridSize=function(){return this.gridSize_},MarkerClusterer.prototype.setGridSize=function(a){this.gridSize_=a},MarkerClusterer.prototype.getMinClusterSize=function(){return this.minClusterSize_},MarkerClusterer.prototype.setMinClusterSize=function(a){this.minClusterSize_=a},MarkerClusterer.prototype.getExtendedBounds=function(a){var b=this.getProjection(),c=new google.maps.LatLng(a.getNorthEast().lat(),a.getNorthEast().lng()),d=new google.maps.LatLng(a.getSouthWest().lat(),a.getSouthWest().lng()),e=b.fromLatLngToDivPixel(c);e.x+=this.gridSize_,e.y-=this.gridSize_;var f=b.fromLatLngToDivPixel(d);f.x-=this.gridSize_,f.y+=this.gridSize_;var g=b.fromDivPixelToLatLng(e),h=b.fromDivPixelToLatLng(f);return a.extend(g),a.extend(h),a},MarkerClusterer.prototype.isMarkerInBounds_=function(a,b){return b.contains(a.getPosition())},MarkerClusterer.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers_=[],this.markersCluster_={},this.markersUniqueID=1},MarkerClusterer.prototype.resetViewport=function(a){var b=this.clusters_.slice();window.setTimeout(function(){for(var c,a=0;c=b[a];a++)c.remove()},0);for(var d,c=0;d=this.markers_[c];c++)d.isAdded=!1,a&&d.setMap(null);this.clusters_=[],this.markersCluster_={},this.markersUniqueID=1},MarkerClusterer.prototype.repaint=function(){this.clusters_.length=0,this.resetViewport(),this.redraw()},MarkerClusterer.prototype.redraw=function(){this.createClusters_()},MarkerClusterer.prototype.toRad_=function(a){return a*Math.PI/180},MarkerClusterer.prototype.distanceBetweenPoints_=function(a,b){if(!a||!b)return 0;var c=this.toRad_(b.lat()),d=this.toRad_(a.lat()),e=.5*(d-c),f=.5*this.toRad_(b.lng()-a.lng()),g=Math.sin(e),h=Math.sin(f),i=g*g+Math.cos(c)*Math.cos(d)*h*h;return 12742*Math.asin(Math.sqrt(i))},MarkerClusterer.prototype.addToClosestCluster_=function(a){for(var g,b=4e4,c=null,e=(a.getPosition(),null),f=0;g=this.clusters_[f];f++){var h=g.getCenter();if(h){var i=this.distanceBetweenPoints_(h,a.getPosition());i<b&&(b=i,c=g,e=f)}}if(c&&c.isMarkerInClusterBounds(a))c.addMarker(a);else{var g=new Cluster(this);g.addMarker(a),this.clusters_.push(g),e=this.clusters_.length-1}a.isAdded&&(this.markersCluster_[a.uniqueID]=e)},MarkerClusterer.prototype.createClusters_=function(){if(this.ready_)for(var d,a=new google.maps.LatLngBounds(this.map_.getBounds().getSouthWest(),this.map_.getBounds().getNorthEast()),b=this.getExtendedBounds(a),c=0;d=this.markers_[c];c++)d.isAdded||!this.isMarkerInBounds_(d,b)||this.ignoreHiddenMarkers_&&!d.getVisible()||this.addToClosestCluster_(d)},Cluster.prototype.getMarkerIndex=function(a){if(this.markers_.indexOf)return this.markers_.indexOf(a);for(var c,b=0;c=this.markers_[b];b++)if(c==a)return b;return-1},Cluster.prototype.addMarker=function(a){if(-1!=this.getMarkerIndex(a))return!1;if(this.center_){if(this.averageCenter_){var b=this.markers_.length+1,c=(this.center_.lat()*(b-1)+a.getPosition().lat())/b,d=(this.center_.lng()*(b-1)+a.getPosition().lng())/b;this.center_=new google.maps.LatLng(c,d),this.calculateBounds_()}}else this.center_=a.getPosition(),this.calculateBounds_();a.isAdded=!0,this.markers_.push(a);var e=this.markers_.length;if(e<this.minClusterSize_&&a.getMap()!=this.map_&&a.setMap(this.map_),e==this.minClusterSize_)for(var f=0;f<e;f++)this.markers_[f].setMap(null);return e>=this.minClusterSize_&&a.setMap(null),this.updateIcon(),!0},Cluster.prototype.removeMarker=function(a){var b=this.getMarkerIndex(a);if(-1===b)return!1;this.markers_.splice(b,1);var c=this.markers_.length;if(c<this.minClusterSize_)for(var d=0;d<c;d++)this.markers_[d].setMap(this.map_);return this.updateIcon(),!0},Cluster.prototype.getMarkerClusterer=function(){return this.markerClusterer_},Cluster.prototype.getBounds=function(){for(var d,a=new google.maps.LatLngBounds(this.center_,this.center_),b=this.getMarkers(),c=0;d=b[c];c++)a.extend(d.getPosition());return a},Cluster.prototype.remove=function(){this.clusterIcon_.remove(),this.markers_.length=0,delete this.markers_},Cluster.prototype.getSize=function(){return this.markers_.length},Cluster.prototype.getMarkers=function(){return this.markers_},Cluster.prototype.getCenter=function(){return this.center_},Cluster.prototype.calculateBounds_=function(){var a=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(a)},Cluster.prototype.isMarkerInClusterBounds=function(a){return this.bounds_.contains(a.getPosition())},Cluster.prototype.getMap=function(){return this.map_},Cluster.prototype.updateIcon=function(){var a=this.map_.getZoom(),b=this.markerClusterer_.getMaxZoom();if(b&&a>b)for(var d,c=0;d=this.markers_[c];c++)d.setMap(this.map_);else{if(this.markers_.length<this.minClusterSize_)return void this.clusterIcon_.hide();var e=this.markerClusterer_.getStyles().length,f=this.markerClusterer_.getCalculator()(this.markers_,e);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.setSums(f),this.clusterIcon_.show()}},ClusterIcon.prototype.triggerClusterClick=function(a){var b=this.cluster_.getMarkerClusterer();google.maps.event.trigger(b,"clusterclick",this.cluster_,a),b.isZoomOnClick()&&this.map_.fitBounds(this.cluster_.getBounds())},ClusterIcon.prototype.triggerClusterMouseover=function(a){var b=this.cluster_.getMarkerClusterer();google.maps.event.trigger(b,"clustermouseover",this.cluster_,a),"function"==typeof this.cluster_.markerClusterer_.onMouseoverCluster_&&this.cluster_.markerClusterer_.onMouseoverCluster_(this,a)},ClusterIcon.prototype.triggerClusterMouseout=function(a){var b=this.cluster_.getMarkerClusterer();google.maps.event.trigger(b,"clustermouseout",this.cluster_,a),"function"==typeof this.cluster_.markerClusterer_.onMouseoutCluster_&&this.cluster_.markerClusterer_.onMouseoutCluster_(this,a)},ClusterIcon.prototype.onAdd=function(){if(this.visible_){this.div_=document.createElement("DIV");var a=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(a),this.div_.innerHTML=this.sums_.text;var b=this.cluster_.getMarkerClusterer();b.cssClass_?this.div_.className=b.cssClass_+" "+b.cssDefaultClass_+this.setIndex_:this.div_.className=b.cssDefaultClass_+this.setIndex_;this.getPanes().overlayMouseTarget.appendChild(this.div_);var d=this,e=!1,f=!1;google.maps.event.addDomListener(this.div_,"click",function(a){e||d.triggerClusterClick(a)}),google.maps.event.addDomListener(this.div_,"mousedown",function(){e=!1,f=!0}),google.maps.event.addDomListener(this.div_,"mouseup",function(){e=!1,f=!1}),google.maps.event.addDomListener(this.div_,"mousemove",function(){f&&(e=!0)}),google.maps.event.addDomListener(this.div_,"mouseover",function(a){d.triggerClusterMouseover(a)}),google.maps.event.addDomListener(this.div_,"mouseout",function(a){d.triggerClusterMouseout(a)})}},ClusterIcon.prototype.getPosFromLatLng_=function(a){var b=this.getProjection().fromLatLngToDivPixel(a);return"object"==typeof this.iconAnchor_&&2===this.iconAnchor_.length?(b.x-=this.iconAnchor_[0],b.y-=this.iconAnchor_[1]):(b.x-=parseInt(this.width_/2,10),b.y-=parseInt(this.height_/2,10)),b},ClusterIcon.prototype.draw=function(){if(this.visible_){var a=this.getPosFromLatLng_(this.center_);this.div_&&(this.div_.style.top=a.y+"px",this.div_.style.left=a.x+"px")}},ClusterIcon.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},ClusterIcon.prototype.show=function(){if(this.div_){var a=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(a),this.div_.style.display=""}this.visible_=!0},ClusterIcon.prototype.remove=function(){this.setMap(null)},ClusterIcon.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),this.div_.parentNode.removeChild(this.div_),this.div_=null)},ClusterIcon.prototype.setSums=function(a){this.sums_=a,this.text_=a.text,this.index_=a.index,this.div_&&(this.div_.innerHTML=a.text),this.useStyle()},ClusterIcon.prototype.useStyle=function(){var a=Math.max(0,this.sums_.index-1);a=Math.min(this.styles_.length-1,a);var b=this.styles_[a];this.url_=b.url,this.height_=b.height,this.width_=b.width,this.textColor_=b.textColor,this.anchor_=b.anchor,this.textSize_=b.textSize,this.backgroundPosition_=b.backgroundPosition,this.iconAnchor_=b.iconAnchor,this.setIndex_=a},ClusterIcon.prototype.setCenter=function(a){this.center_=a},ClusterIcon.prototype.createCss=function(a){var b=[];if(this.cluster_.getMarkerClusterer().cssClass_)b.push("top:"+a.y+"px; left:"+a.x+"px;");else{b.push("background-image:url("+this.url_+");");var d=this.backgroundPosition_?this.backgroundPosition_:"0 0";b.push("background-position:"+d+";"),"object"==typeof this.anchor_?("number"==typeof this.anchor_[0]&&this.anchor_[0]>0&&this.anchor_[0]<this.height_?b.push("height:"+(this.height_-this.anchor_[0])+"px; padding-top:"+this.anchor_[0]+"px;"):"number"==typeof this.anchor_[0]&&this.anchor_[0]<0&&-this.anchor_[0]<this.height_?b.push("height:"+this.height_+"px; line-height:"+(this.height_+this.anchor_[0])+"px;"):b.push("height:"+this.height_+"px; line-height:"+this.height_+"px;"),"number"==typeof this.anchor_[1]&&this.anchor_[1]>0&&this.anchor_[1]<this.width_?b.push("width:"+(this.width_-this.anchor_[1])+"px; padding-left:"+this.anchor_[1]+"px;"):b.push("width:"+this.width_+"px; text-align:center;")):b.push("height:"+this.height_+"px; line-height:"+this.height_+"px; width:"+this.width_+"px; text-align:center;");var e=this.textColor_?this.textColor_:"black",f=this.textSize_?this.textSize_:11;b.push("cursor:pointer; top:"+a.y+"px; left:"+a.x+"px; color:"+e+"; position:absolute; font-size:"+f+"px; font-family:Arial,sans-serif; font-weight:bold")}return b.join("")},window.MarkerClusterer=MarkerClusterer,MarkerClusterer.prototype.addMarker=MarkerClusterer.prototype.addMarker,MarkerClusterer.prototype.addMarkers=MarkerClusterer.prototype.addMarkers,MarkerClusterer.prototype.clearMarkers=MarkerClusterer.prototype.clearMarkers,MarkerClusterer.prototype.fitMapToMarkers=MarkerClusterer.prototype.fitMapToMarkers,MarkerClusterer.prototype.getCalculator=MarkerClusterer.prototype.getCalculator,MarkerClusterer.prototype.getGridSize=MarkerClusterer.prototype.getGridSize,MarkerClusterer.prototype.getExtendedBounds=MarkerClusterer.prototype.getExtendedBounds,MarkerClusterer.prototype.getMap=MarkerClusterer.prototype.getMap,MarkerClusterer.prototype.getMarkers=MarkerClusterer.prototype.getMarkers,MarkerClusterer.prototype.getMaxZoom=MarkerClusterer.prototype.getMaxZoom,MarkerClusterer.prototype.getMarkersCluster=MarkerClusterer.prototype.getMarkersCluster,MarkerClusterer.prototype.getStyles=MarkerClusterer.prototype.getStyles,MarkerClusterer.prototype.getTotalClusters=MarkerClusterer.prototype.getTotalClusters,MarkerClusterer.prototype.getTotalMarkers=MarkerClusterer.prototype.getTotalMarkers,MarkerClusterer.prototype.redraw=MarkerClusterer.prototype.redraw,MarkerClusterer.prototype.removeMarker=MarkerClusterer.prototype.removeMarker,MarkerClusterer.prototype.removeMarkers=MarkerClusterer.prototype.removeMarkers,MarkerClusterer.prototype.resetViewport=MarkerClusterer.prototype.resetViewport,MarkerClusterer.prototype.repaint=MarkerClusterer.prototype.repaint,MarkerClusterer.prototype.setCalculator=MarkerClusterer.prototype.setCalculator,MarkerClusterer.prototype.setGridSize=MarkerClusterer.prototype.setGridSize,MarkerClusterer.prototype.setMaxZoom=MarkerClusterer.prototype.setMaxZoom,MarkerClusterer.prototype.onAdd=MarkerClusterer.prototype.onAdd,MarkerClusterer.prototype.draw=MarkerClusterer.prototype.draw,Cluster.prototype.getCenter=Cluster.prototype.getCenter,Cluster.prototype.getSize=Cluster.prototype.getSize,Cluster.prototype.getMarkers=Cluster.prototype.getMarkers,ClusterIcon.prototype.onAdd=ClusterIcon.prototype.onAdd,ClusterIcon.prototype.draw=ClusterIcon.prototype.draw,ClusterIcon.prototype.onRemove=ClusterIcon.prototype.onRemove;
